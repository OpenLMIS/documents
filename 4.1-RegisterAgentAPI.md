# Create virtual facility API

### Communication Type

- HTTP Post, to OpenLMIS
 
### Authentication

- Authentication token (Base64 encrypted string containing username:password)

### Parameters

- agentCode - Mandatory
- agentName - Mandatory
- baseFacilityCode - Mandatory
- phoneNumber - Optional
- Active - Optional (By default will be considered as "active")

### Return

"Success" or "Error" code

### Error scenarios

#### *Invalid authentication*  
**Response**: Authentication Failed  
**Description**: This error can be caused by an incorrect API username, an incorrect API password, or an invalid API signature. Make sure that all three of these values are correct.

#### *Any mandatory field missing*
**Response**: Mandatory field Missing  
**Description**: This error will occur if any of the manadatory field (agentCode, agentName or baseFacilityCode) is either null or tag is missing.

#### *Invalid baseFacilityCode*
**Response**: Invalid baseFacilityCode  
**Description**: basefacilityCode is the facilityCode of facilities registered in OpenLMIS and sent to CommTrack as part of "facilityMasterFeed". This error will occur if:-  
a) basefacilityCode in the API does not exist in OpenLMIS.  
b) basefacilityCode in the API is a virtual facility registered earlier in OpenLMIS. As a CHW (virtual facility) cannot be mapped to another CHW, OpenLMIS will check that baseFacilityCode should not be a virtual facility.

#### *agentCode already exists*
**Response**: Agent already registered  
**Description**: This error will occur if "createVirtualFacility" request is received with a agentCode that is already registered in OpenLMIS. An agent can be updated by "updatevirtualFacility" API.

#### *Malformed JSON*
**Response**: Invalid JSON  
**Description**: This error will occur if there is some formatting error in JSON.

#### *Unrecognized field*
**Response**: Invalid field found  
**Description**: This error will occur if any unrecognized field (apart from fields mentioned in parameters) is sent as part of API.

### Notes

CommTrack will use this API to notify OpenLMIS everytime a new CHW is created. OpenLMIS will store agentCode as an identifier for this CHW/satellite facility and use it to match up successive reports coming from CHW.
Error scenarios :-

### JSON: Coming soon

